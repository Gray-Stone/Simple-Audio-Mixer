# Simple 2-in-1-out Audio Merger

## Design choices and reason for decision

Overview 
=========

Core feature:
-------------

Simple Audio Merger (SAM) is designed to be used for merging audio from
2 sources and simply output the added voltage to output. Input is design
for common consumer appliances with stereo audio, and there will not be
any processing other than summation on board. The output is only
buffered (powered) by an Opamp, and a power amplifier should be used if
the load is not high impedance (headphone, speaker is typical low
impedance load).

Power Option
============

3.5mm stereo audio jack will be used as audio interface for both input
and output. This is the most common form of audio connection between
desktop device and is simplest.

Power source 
-------------

Possible choice of USB power and battery power.

Benefit of USB supply:

-   Device’s original design is to be used to merge audio from computer
    and gamming console, this means abundant USB supplies.

Problem with USB supply:

-   Huge amount of noise (USB data line, other USB devices, etc.)

-   Single Rail, and the lower rail is mains-earth reference (virtual
    ground cannot be connected with other devices)

Reason to choose battery supply:

-   Clean rail.

-   Easily generated negative rail (or virtual ground).

-   Since floating rail, no requirement before connecting ground with
    other device (virtual or not)

Problem with battery:

-   Need replace battery

-   Need a battery management system to detect low battery and
    shutoff/notice user before it causes problem

The USB high power rail noise is not much of a problem given all signal
goes through Opamp, which have great rail rejection.

The battery replacement is not that bad, this design does not provide
power amplifier. Most power are used by Opamp. So, replacement cycle is
not as often. In addition, audio signal is basically below 1V, two AA
battery will be enough for dual rails.

Both choices are ok, if a battery is chosen, then BMS is needed. If USB
is chosen, negative rail is needed.

Dual Rail generation 
---------------------

If USB power is used, a negative rail must be generated. Generate a half
rail virtual ground is not suitable in this case.

A voltage reference is generally generated by a voltage buffer with
input connect to a revers biased zener. The zener voltage is set by
current, despite little, but still fluctuate with current change. The
source current for zener voltage is usually set by resistor, which is
voltage controlled current.

USB is mains-earth referenced ground. The audio ground from other device
(input and output amplifier) is the same mains-earth reference as well.
This means the virtual ground can not be connected to another device.

When using virtual ground, the output voltage is referenced to virtual
ground. The voltage ripple across “negative rail” and virtual ground is
considered rail noise. However, since other device is also ground
referenced, they see they “negative rail” noise as a noise added to
virtual ground. Since output is referenced to virtual ground, outside
device also see this noise as part of the output signal (instead of
common mode noise).

If battery is used, then a virtual ground is easily generated by
connecting a lead from middle of the two batteries. This virtual ground
will be push pull and very stable in voltage. Furthermore, battery is
floating voltage device, the virtual ground can be connected to any
mains-earth connection. This connection makes it remove some common-mode
noise.

Merge Audio Signal
==================

Resistor Summing Circuit.
-------------------------

Audio signal are generally a voltage signal. One possible choice is to
connect everything through a resistor to a summing point. The resistor
turns the voltage signal into current signal. Then transconductance
amplifier can easily turn that into output voltage.

In this case, the impedance each input device see depends on the
resistance and other device it sees.

Individual Opamp Buffered.
--------------------------

If each input is first buffered by an opamp, then all input device sees
high impedance which is decoupled from others. In the case of a low
impedance (high power) device on input side, buffer Opamp prevent other
input device get loaded.

Decision
========

-   USB power source with negative rail (No BMS required, Opamp have
    good PSRR).

-   Opamp buffered input (Opamp are cheap, this is a one-off board).
